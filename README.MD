
# Serbian Transport Integration

![Version](https://img.shields.io/badge/version-2.2.0-blue.svg)
![HACS](https://img.shields.io/badge/HACS-compatible-orange.svg)
![Home Assistant](https://img.shields.io/badge/Home%20Assistant-2025.1.0+-green.svg)

[![Open your Home Assistant instance and open a repository inside the Home Assistant Community Store.](https://my.home-assistant.io/badges/hacs_repository.svg)](https://my.home-assistant.io/redirect/hacs_repository/?owner=dzarlax&repository=HASS-Serbian-transport&category=integration)

Advanced Home Assistant integration for Serbian public transport with real-time arrivals, beautiful animations, and visual configuration.

## âœ¨ Features

### Core Features
- ğŸšŒ **Real-time transport arrivals** - Live data from official transport APIs
- ğŸ“ **Coordinate-based discovery** - Automatically finds nearby stops using your coordinates
- ğŸ¨ **Modern visual interface** - Beautiful animations, color-coded arrivals, progress bars
- âš™ï¸ **Visual configuration** - Easy setup through Home Assistant UI (no YAML required)
- ğŸ“± **Responsive design** - Works perfectly on mobile and desktop

### Advanced Features
- ğŸ¯ **Next departure highlighting** - Shows the soonest arrival across all stops
- ğŸ“Š **Progress bars** - Visual time indicators with color coding
- ğŸ”„ **Expandable view** - Compact/expanded modes for different use cases
- ğŸ­ **Smooth animations** - Hover effects and transitions for modern UX
- ğŸ”§ **Migration support** - Seamless updates from older versions

## ğŸ™ï¸ Supported Cities
- **Belgrade** (GSP Belgrade)
- **Novi Sad** (JGSP Novi Sad) 
- **NiÅ¡** (JKP Direkcija za javni prevoz grada NiÅ¡a)

## ğŸ“¦ Installation

### One-Click Installation (Easiest)
Click the button below to automatically open HACS and install the integration:

[![Open your Home Assistant instance and open a repository inside the Home Assistant Community Store.](https://my.home-assistant.io/badges/hacs_repository.svg)](https://my.home-assistant.io/redirect/hacs_repository/?owner=dzarlax&repository=HASS-Serbian-transport&category=integration)

After installation, add the integration to your Home Assistant:

[![Open your Home Assistant instance and start setting up a new integration.](https://my.home-assistant.io/badges/config_flow_start.svg)](https://my.home-assistant.io/redirect/config_flow_start/?domain=serbian_transport)

### Via HACS (Manual)
1. Open HACS in Home Assistant
2. Go to "Integrations"
3. Click "Explore & Download Repositories"
4. Search for "Serbian Transport"
5. Download and install
6. Restart Home Assistant
7. Add integration: **Settings** â†’ **Devices & Services** â†’ **Add Integration** â†’ **Serbian Transport**

### Manual Installation
1. Copy the `serbian_transport` folder to your `custom_components` directory
2. Restart Home Assistant
3. Add the integration through the UI

## ğŸ›ï¸ Configuration

### Integration Setup
1. **Settings** â†’ **Devices & Services** â†’ **Add Integration**
2. Search for "Serbian Transport"
3. Enter your coordinates (or use Home Assistant defaults)
4. Set search radius (100-20000 meters)
5. Save configuration

### Card Configuration

#### Visual UI Configuration (Recommended)
1. Add card to dashboard
2. Choose **"Serbian Transport Card"** from the list
3. Configure using the visual editor:
   - **Entity**: Select your transport sensor
   - **Title**: Custom card title
   - **Max Stations**: Number of stations to display (1-50)
   - **Show Next Departure**: Toggle next departure section
   - **Compact View**: Default view mode
   - **Refresh Interval**: Data update frequency (10-300 seconds)

#### YAML Configuration (Advanced)
```yaml
type: custom:transport-card
entity: sensor.serbian_transport_stations_count
title: "Serbian Transport"
show_next_departure: true
compact_view: false
max_stations: 10
refresh_interval: 30
```

### Configuration Options

| Option | Type | Default | Description |
|--------|------|---------|-------------|
| `entity` | string | **required** | Transport sensor entity ID |
| `title` | string | `"Serbian Transport"` | Card title |
| `show_next_departure` | boolean | `true` | Show next departure section |
| `compact_view` | boolean | `false` | Use compact layout by default |
| `max_stations` | number | `10` | Maximum stations to display (1-50) |
| `refresh_interval` | number | `30` | Update interval in seconds (10-300) |

## ğŸ¨ Visual Features

### Color-Coded Arrivals
- ğŸ”´ **Urgent** (â‰¤2 min) - Red gradient
- ğŸŸ  **Soon** (â‰¤5 min) - Orange gradient  
- ğŸŸ¢ **Normal** (â‰¤15 min) - Green gradient
- ğŸ”µ **Late** (>15 min) - Blue gradient

### Interactive Elements
- **Hover effects** on transport groups
- **Expandable/collapsible** view with animation
- **Progress bars** showing time until arrival
- **Status indicators** for station data availability

## ğŸ”§ Troubleshooting

### Card Not Appearing
The card should be automatically registered. If it doesn't appear:

1. **Settings** â†’ **Dashboards** â†’ **Resources**
2. Add new resource: `/hacsfiles/HASS-Serbian-transport/transport-card.js`
3. Type: **JavaScript Module**
4. Refresh browser (Ctrl+F5)

### No Data Showing
- Check if coordinates are correct
- Verify search radius (try increasing it)
- Ensure internet connectivity
- Check Home Assistant logs for errors

### Migration Issues
If upgrading from an older version:
- The integration automatically migrates old configurations
- Clear browser cache if the card doesn't update
- Check entity names (might have changed)

## ğŸ—ï¸ Development

This integration is part of the [City Dashboard](https://github.com/dzarlax/city-dashboard) project.

### API Endpoints
- **Production**: `https://transport-api.dzarlax.dev`
- **Fallback cities**: Belgrade (`bg`), Novi Sad (`ns`), NiÅ¡ (`nis`)

### Version History
- **v2.2.0**: Simplified interface, removed complex filtering
- **v2.1.x**: Advanced features with sorting and favorites
- **v2.0.0**: Major rewrite with visual configuration
- **v1.x**: Initial release with basic functionality


# Srpski Transport Integracija

![Verzija](https://img.shields.io/badge/verzija-2.2.0-blue.svg)
![HACS](https://img.shields.io/badge/HACS-kompatibilna-orange.svg)
![Home Assistant](https://img.shields.io/badge/Home%20Assistant-2025.1.0+-green.svg)

[![Otvorite vaÅ¡u Home Assistant instancu i dodajte repozitorijum u Home Assistant Community Store.](https://my.home-assistant.io/badges/hacs_repository.svg)](https://my.home-assistant.io/redirect/hacs_repository/?owner=dzarlax&repository=HASS-Serbian-transport&category=integration)

Napredna Home Assistant integracija za srpski javni prevoz sa dolaskom u realnom vremenu, lepim animacijama i vizuelnom konfiguracijom.

## âœ¨ Funkcije

### Osnovne funkcije
- ğŸšŒ **Dolasci prevoza u realnom vremenu** - Å½ivi podaci sa zvaniÄnih transport API-ja
- ğŸ“ **Otkrivanje bazirano na koordinatama** - Automatski pronalazi obliÅ¾nje stanice koristeÄ‡i vaÅ¡e koordinate
- ğŸ¨ **Moderan vizuelni interfejs** - Lepe animacije, dolasci u boji, trake napretka
- âš™ï¸ **Vizuelna konfiguracija** - Lako podeÅ¡avanje kroz Home Assistant UI (YAML nije potreban)
- ğŸ“± **Responsive dizajn** - SavrÅ¡eno radi na mobilnim ureÄ‘ajima i desktopima

### Napredne funkcije  
- ğŸ¯ **OznaÄavanje sledeÄ‡eg polaska** - Prikazuje najraniji dolazak preko svih stanica
- ğŸ“Š **Trake napretka** - Vizuelni indikatori vremena sa kodiranjem u boji
- ğŸ”„ **ProÅ¡iriv prikaz** - Kompaktni/proÅ¡ireni reÅ¾imi za razliÄite sluÄajeve koriÅ¡Ä‡enja
- ğŸ­ **Glatke animacije** - Hover efekti i prelazi za moderan UX
- ğŸ”§ **PodrÅ¡ka za migraciju** - Besprekorne nadogradnje sa starijih verzija

## ğŸ™ï¸ PodrÅ¾ani gradovi
- **Beograd** (GSP Beograd)
- **Novi Sad** (JGSP Novi Sad)
- **NiÅ¡** (JKP Direkcija za javni prevoz grada NiÅ¡a)

## ğŸ“¦ Instalacija

### Instalacija jednim klikom (NajlakÅ¡e)
Kliknite dugme ispod da automatski otvorite HACS i instalirate integraciju:

[![Otvorite vaÅ¡u Home Assistant instancu i dodajte repozitorijum u Home Assistant Community Store.](https://my.home-assistant.io/badges/hacs_repository.svg)](https://my.home-assistant.io/redirect/hacs_repository/?owner=dzarlax&repository=HASS-Serbian-transport&category=integration)

Nakon instalacije, dodajte integraciju u vaÅ¡ Home Assistant:

[![Otvorite vaÅ¡u Home Assistant instancu i poÄnite podeÅ¡avanje nove integracije.](https://my.home-assistant.io/badges/config_flow_start.svg)](https://my.home-assistant.io/redirect/config_flow_start/?domain=serbian_transport)

### Preko HACS-a (RuÄno)
1. Otvorite HACS u Home Assistant-u
2. Idite na "Integracije"
3. Kliknite "IstraÅ¾ite i preuzmite repozitorijume"
4. TraÅ¾ite "Serbian Transport"
5. Preuzmite i instalirajte
6. Restartujte Home Assistant
7. Dodajte integraciju: **PodeÅ¡avanja** â†’ **UreÄ‘aji i Servisi** â†’ **Dodaj Integraciju** â†’ **Serbian Transport**

### RuÄna instalacija
1. Kopirajte `serbian_transport` folder u vaÅ¡ `custom_components` direktorijum
2. Restartujte Home Assistant
3. Dodajte integraciju preko UI-ja

## ğŸ›ï¸ Konfiguracija

### PodeÅ¡avanje integracije
1. **PodeÅ¡avanja** â†’ **UreÄ‘aji i Servisi** â†’ **Dodaj Integraciju**
2. TraÅ¾ite "Serbian Transport"
3. Unesite vaÅ¡e koordinate (ili koristite Home Assistant podrazumevane)
4. Postavite radijus pretrage (100-20000 metara)
5. SaÄuvajte konfiguraciju

### Konfiguracija kartice

#### Vizuelna UI konfiguracija (PreporuÄeno)
1. Dodajte karticu na kontrolnu tablu
2. Izaberite **"Serbian Transport Card"** sa liste
3. KonfiguriÅ¡ite koristeÄ‡i vizuelni editor:
   - **Entity**: Izaberite vaÅ¡ transport senzor
   - **Title**: PrilagoÄ‘eni naslov kartice
   - **Max Stations**: Broj stanica za prikaz (1-50)
   - **Show Next Departure**: UkljuÄi/iskljuÄi sekciju sledeÄ‡eg polaska
   - **Compact View**: Podrazumevani reÅ¾im prikaza
   - **Refresh Interval**: Frekvencija aÅ¾uriranja podataka (10-300 sekundi)

#### YAML konfiguracija (Napredna)
```yaml
type: custom:transport-card
entity: sensor.serbian_transport_stations_count
title: "Serbian Transport"
show_next_departure: true
compact_view: false
max_stations: 10
refresh_interval: 30
```

### Opcije konfiguracije

| Opcija | Tip | Podrazumevano | Opis |
|--------|-----|---------------|------|
| `entity` | string | **obavezno** | ID transport senzor entiteta |
| `title` | string | `"Serbian Transport"` | Naslov kartice |
| `show_next_departure` | boolean | `true` | PrikaÅ¾i sekciju sledeÄ‡eg polaska |
| `compact_view` | boolean | `false` | Koristi kompaktni layout po default-u |
| `max_stations` | number | `10` | Maksimalno stanica za prikaz (1-50) |
| `refresh_interval` | number | `30` | Interval aÅ¾uriranja u sekundama (10-300) |

## ğŸ¨ Vizuelne funkcije

### Dolasci oznaÄeni bojama
- ğŸ”´ **Hitno** (â‰¤2 min) - Crveni gradijent
- ğŸŸ  **Uskoro** (â‰¤5 min) - NarandÅ¾asti gradijent
- ğŸŸ¢ **Normalno** (â‰¤15 min) - Zeleni gradijent
- ğŸ”µ **Kasno** (>15 min) - Plavi gradijent

### Interaktivni elementi
- **Hover efekti** na transport grupama
- **ProÅ¡iriv/sklopiv** prikaz sa animacijom
- **Trake napretka** koje prikazuju vreme do dolaska
- **Status indikatori** za dostupnost podataka stanice

## ğŸ”§ ReÅ¡avanje problema

### Kartica se ne pojavljuje
Kartica treba da bude automatski registrovana. Ako se ne pojavljuje:

1. **PodeÅ¡avanja** â†’ **Kontrolne table** â†’ **Resursi**
2. Dodajte novi resurs: `/hacsfiles/HASS-Serbian-transport/transport-card.js`
3. Tip: **JavaScript Module**
4. OsveÅ¾ite browser (Ctrl+F5)

### Nema podataka
- Proverite da li su koordinate ispravne
- Proverite radijus pretrage (pokuÅ¡ajte da ga poveÄ‡ate)
- Obezbedite internet konekciju
- Proverite Home Assistant logove za greÅ¡ke

### Problemi sa migracijom
Ako nadograÄ‘ujete sa starije verzije:
- Integracija automatski migrira stare konfiguracije
- Obrisite browser keÅ¡ ako se kartica ne aÅ¾urira
- Proverite imena entiteta (moÅ¾da su se promenila)

## ğŸ—ï¸ Razvoj

Ova integracija je deo [City Dashboard](https://github.com/dzarlax/city-dashboard) projekta.

### API Endpoints
- **Produkcija**: `https://transport-api.dzarlax.dev`
- **Fallback gradovi**: Beograd (`bg`), Novi Sad (`ns`), NiÅ¡ (`nis`)

### Istorija verzija
- **v2.2.0**: UproÅ¡Ä‡en interfejs, uklonjeno sloÅ¾eno filtriranje
- **v2.1.x**: Napredne funkcije sa sortiranjem i omiljenim
- **v2.0.0**: Velika prepravka sa vizuelnom konfiguracijom
- **v1.x**: PoÄetno izdanje sa osnovnim funkcionalnostima


## Attribution / Atribucija

In this project, the bus icon from [Flaticon](https://www.flaticon.com/free-icons/bus) is used. Bus icons created by Freepik - Flaticon.

U ovom projektu koriÅ¡Ä‡ena je ikonica autobusa sa [Flaticon](https://www.flaticon.com/free-icons/bus). Bus ikonice kreirao Freepik - Flaticon.